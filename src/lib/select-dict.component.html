<div *ngIf="label" class="form-group">
  <label>{{label}}</label>
  <div class="select-dict dropdown">
    <div class="form-control dropdown-toggle hide-overflowed-text"
         [ngClass]="size === 'sm' ? 'form-control-sm' : ''"
         tabindex="0"
         appSelectMatch
         [focus]="focusMatch"
         [hidden]="opened"
         (keydown.enter)="onOpen()"
         (click)="onOpen($event)">
      <ng-template *ngIf="selected"
                   [ngTemplateOutlet]="matchTemplate"
                   [ngTemplateOutletContext]="{$implicit: selected}">
      </ng-template>
      <span *ngIf="!selected">{{placeholder || label}}</span>
    </div>
    <input
      *ngIf="opened"
      #searchInput
      class="form-control search-input"
      [ngClass]="size === 'sm' ? 'form-control-sm' : ''"
      appSelectSearch
      [focus]="focusSearch"
      (keyup)="onSearch(searchInput.value)"
      (keydown.enter)="selectHighlighted()"
      (keydown.arrowup)="activatePrev()"
      (keydown.arrowdown)="activateNext()">
    <app-select-dict-choices
      *ngIf="opened"
      [choices]="items"
      [indexBy]="indexBy"
      [search]="search"
      [showPreviousPageButton]="longList && page !== 0"
      [showNextPageButton]="longList && !(items?.length < listSize)"
      [active]="active"
      [activeIndex]="activeIndex"
      [template]="choicesTemplate"
      (onSelect)="onSelect($event)"
      (nextPage)="getNextPage()"
      (prevPage)="getPrevPage()"
    ></app-select-dict-choices>
  </div>
</div>
<div *ngIf="label === undefined || label === null" class="select-dict dropdown">
  <div class="form-control dropdown-toggle hide-overflowed-text"
       [ngClass]="size === 'sm' ? 'form-control-sm' : ''"
       tabindex="0"
       appSelectMatch
       [focus]="focusMatch"
       [hidden]="opened"
       (keydown.enter)="onOpen()"
       (click)="onOpen($event)">
    <ng-template *ngIf="selected"
                 [ngTemplateOutlet]="matchTemplate"
                 [ngTemplateOutletContext]="{$implicit: selected}">
    </ng-template>
    <div class="placeholder" *ngIf="!selected">{{placeholder || label}}</div>
  </div>
  <input
    *ngIf="opened"
    #searchInput
    class="form-control search-input"
    [ngClass]="size === 'sm' ? 'form-control-sm' : ''"
    appSelectSearch
    [focus]="focusSearch"
    (keyup)="onSearch(searchInput.value)"
    (keydown.enter)="selectHighlighted()"
    (keydown.arrowup)="activatePrev()"
    (keydown.arrowdown)="activateNext()">
  <app-select-dict-choices
    [ngClass]="size === 'sm' ? 'sm' : ''"
    *ngIf="opened"
    [choices]="items"
    [indexBy]="indexBy"
    [search]="search"
    [showPreviousPageButton]="longList && page !== 0"
    [showNextPageButton]="longList && !(items?.length < listSize)"
    [active]="active"
    [activeIndex]="activeIndex"
    [template]="choicesTemplate"
    (onSelect)="onSelect($event)"
    (nextPage)="getNextPage()"
    (prevPage)="getPrevPage()"
  ></app-select-dict-choices>
</div>
